Going on a blind date with your read set? For a better understanding of
the consequences please check the data quality!

For the purpose of this tutorial we are focusing only on Illumina
sequencing which uses ’sequence by synthesis’ technology in a highly
parallel fashion. Although Illumina high throughput sequencing provides
highly accurate sequence data, several sequence artifacts, including
base calling errors and small insertions/deletions, poor quality reads
and primer/adapter contamination are quite common in the high throughput
sequencing data. The primary errors are substitution errors. The error
rates can vary from 0.5-2.0% with errors mainly rising in frequency at
the 3’ ends of reads.

One way to investigate sequence data quality is to visualize the quality
scores and other metrics in a compact manner to get an idea about the
quality of a read data set. Read data sets can be improved by pre
processing in different ways like trimming off low quality bases,
cleaning up any sequencing adapters, removing PCR duplicates and
screening for contamination. We can also look at other statistics such
as, sequence length distribution, base composition, sequence complexity,
presence of ambiguous bases etc. to assess the overall quality of the
data set.

Highly redundant coverage (>15X) of the genome can be used to correct
sequencing errors in the reads before assembly. Various k-mer based
error correction methods exist but are beyond the scope of this
tutorial.

### Quality Value Encoding Schema

Quality scoring calculates a set of predictors for each base call, and then uses the predictor
values to look up the Q-score in a quality table. Quality tables are created to provide optimally
accurate quality predictions for runs generated by a specific configuration of sequencing
platform and version of chemistry (www.illumina.com).
In order to use a single character to encode Phred qualities, [ASCII characters](https://www.ibm.com/support/knowledgecenter/en/ssw_aix_72/network/conversion_table.html) are used. All ASCII characters have a decimal number associated with them but the first 32
characters are non-printable (e.g. backspace, shift, return, escape).
Therefore, the first printable ASCII character is number 33, the
exclamation mark (`!`). In Phred+33 encoded quality values the exclamation
mark takes the Phred quality score of zero.

Early Solexa (now Illumina) sequencing needed to encode negative quality
values. Because ASCII characters < 33 are non-printable, using the
Phred+33 encoding was not possible. Therefore, they simply moved the
offset from 33 to 64 thus inventing the Phred+64 encoded quality values.
In this encoding a Phred quality of zero is denoted by the ASCII number
64 (the @ character). Since Illumina 1.8, quality values are now encoded
using Phred+33.


FASTQ does not provide a way to describe what quality encoding is used
for the quality values. Therefore, you should find this out from your
sequencing provider. Alternatively, you may be able to figure this out
by determining what ASCII characters are present in the FASTQ file. E.g
the presence of numbers in the quality strings, can only mean the
quality values are Phred+33 encoded. However, due to the overlapping
nature of the Phred+33 and Phred+64 encoding schema it is not always
possible to identify what encoding is in use. For example, if the only
characters seen in the quality string are (`@ABCDEFGHI`), then it is
impossible to know if you have really good Phred+33 encoded qualities or
really bad Phred+64 encoded qualities.

For a graphical representation of the different ASCII characters used in
the two encoding schema see: http://en.wikipedia.org/wiki/FASTQ_format#Encoding


### Q-score encoding implemented with the Novaseq platform

In order to reduce the data footprints Illumina has come up with a new
method to reduce quality score resolution and optimise data storae. The new Q-score
encoding now follows an 8 level mapping of individual quality scores (0-40 or >40) [See **Table 1**].
With the new scoring scheme the original scores 20-24 may form one bin and the quality scores in that
bin mapped to a new value of 22. This can be thought of as simply replacing all the
occurrences of scores 20, 21, 23, 24 with a new score of 22 in the output sequence.
Illumina claims that with the new Q-scoring system the reduction in the Illumina raw sequence format (.bcl) is typically > 50% and the resulting sorted BAM  les are reduced by ~30%.

Quality Score Bins | Mapped quality scores
:----------|:-------------
N (no call) | N (no call)
2-9 | 6  
10-19 | 15  
20-24 | 22
25-29 | 27
30-34 | 33
35-39 | 37
\>=40 | 40

**Table 1:** Novaseq Q-score bins mapping
